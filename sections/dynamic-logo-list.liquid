<script type="application/pxs-animation-mapping+json">
  {
    "blocks": [
      ".logo-list__logo-wrapper"
    ],
    "elements": [
      ".logo-list-logo"
    ]
  }
</script>

{% liquid
  assign section = section
  assign section_heading = section.settings.title
  assign mobile_layout = section.settings.mobile_layout
  assign logo_image_id = 'image'
  assign logo_url_id = 'link'
  assign section_classes = mobile_layout

  if section.settings.show_border == false
    assign section_classes = section_classes | append: ' no-section-border'
  endif
%}

<script
  type="application/json"
  data-section-type="dynamic-logo-list"
  data-section-id="{{ section.id }}"
  data-section-data
>
  {
    "mobile_layout": {{ mobile_layout | json }}
  }
</script>

{% comment %}Inject @pixelunion/pxs-logo-list/logo-list begin{% endcomment %}
{% comment %}
  @param section {Object} {REQUIRED}
    The section object with all section data

  @param logo_image_id {String} {REQUIRED}
    Block setting ID for logo image

  @param section_classes {String}
    A string separated list of classes to apply to the section element

  @param section_attributes {String}
    A string separated list of attributes to apply to the section element

  @param section_heading {String}
    The section heading

  @param section_subheading {String}
    The section subheading

  @param logo_list_classes {String}
    Classes to be applied to the logo list wrapper

  @param logo_list_attributes {String}
    Attributes to be applied to the logo list wrapper

  @param logo_url_id {String}
    Block setting ID for logo URL
{% endcomment %}

{% liquid
  assign section_classes = section_classes | default: ''
  assign section_attributes = section_attributes | default: ''
  assign section_heading = section_heading | default: ''
  assign section_subheading = section_subheading | default: ''
  assign logo_list_classes = logo_list_classes | default: ''
  assign logo_list_attributes = logo_list_attributes | default: ''
  assign logo_url_id = logo_url_id | default: ''
  assign aria_label = section_heading
  assign blocks = section.blocks
%}

{% if aria_label == blank %}
  {% assign aria_label = 'sections.logo-list.onboarding.aria_label' | t %}
{% endif %}

<section
  class="
    logo-list
    {{ section_classes }}
  "
  aria-label="{{ aria_label }}"
  {{ section_attributes }}
>
  {% unless section_heading == blank and section_subheading == blank %}
    <div class="logo-list__section-header section__header">
      {% if section_heading != blank %}
        <h2 class="logo-list__heading section__heading">
          {{- section_heading | escape -}}
        </h2>
      {% endif %}

      {% if section_subheading != blank %}
        <div class="logo-list__subheading section__subheading">
          {{- section_subheading -}}
        </div>
      {% endif %}
    </div>
  {% endunless %}

  <div
    class="
      logo-list__logo-wrapper
      {{ logo_list_classes }}
    "
    {{ logo_list_attributes }}
    data-logo-list-wrapper
  >
    {% for block in blocks %}
      {% liquid
        assign logo_image = block.settings[logo_image_id]
        assign logo_url = ''

        if logo_url_id != blank
          assign logo_url = block.settings[logo_url_id]
        endif
      %}

      {%
        render 'logo-list-logo',
        logo_url: logo_url,
        logo_image: logo_image,
      %}
    {% endfor %}
  </div>
</section>
{% comment %}Inject @pixelunion/pxs-logo-list/logo-list end{% endcomment %}


{% schema %}
{
  "name": "t:sections.logo_list.name",
  "class": "shopify-section--logo-list",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "t:sections.logo_list.title.label",
      "default": "Logo list"
    },
    {
      "type": "checkbox",
      "id": "show_border",
      "label": "t:sections.logo_list.show_border.label",
      "default": true
    },
    {
      "type": "select",
      "id": "mobile_layout",
      "label": "t:sections.logo_list.mobile_layout.label",
      "options": [
        {
          "value": "grid",
          "label": "t:sections.logo_list.mobile_layout.option_1"
        },
        {
          "value": "slider",
          "label": "t:sections.logo_list.mobile_layout.option_2"
        }
      ],
      "default": "slider"
    }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "t:sections.logo_list.blocks.logo.name",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.logo_list.blocks.logo.image.label",
          "info": "t:sections.logo_list.blocks.logo.image.info"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:sections.logo_list.blocks.logo.link.label"
        }
      ]
    }
  ],
  "presets": [
    {
      "category": "t:sections.logo_list.presets.category",
      "name": "t:sections.logo_list.presets.name",
      "blocks": [
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        },
        {
          "type": "logo"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": [
      "*"
    ]
  }
}

{% endschema %}